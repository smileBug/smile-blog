---
title: JavaScript 作用域变量查询
date: 2016-07-20 15:56:48
categories:
 JS
tags:
 - 作用域
---
### 作用域
作用域是一套用于确定在何处以及如何查找变量的规则。
<!-- more -->
### 变量查询
如果查找的目的是为了对变量进行赋值，则会使用LHS查询；如果查找的目的是为了获取变量的值，则会使用RHS查询。其中“L”和“R”的含义不难猜测，它们分别代表左侧和右侧。换句话说，当变量出现在赋值操作的左边进行LHS查询，出现在右侧时进行RHS查询。

例如代码：
```javascript
var a = 3，
    b = a;
console.log(a);
```
其中对于“var a = 3”js引擎会为等号左边变量a进行LHS查询，试图找到变量的容器本身，从而可以对其赋值；而对于“b = a”中等号右边的变量a则是进行RHS查询，可以理解“取得a的值”，然后赋值给变量b；最后对于“console.log(a)”中对于变量a也是进行RHS查询，并且将得到的值传给console.log(..)执行。
所以最好将其理解成“给谁进行赋值操作（LHS）”以及“获取谁的值（RHS）”
### 作用域嵌套
当一个函数嵌套在另一个函数中时，就会发生作用域的嵌套。因此，在当前作用域中无法找到某个变量时，引擎就会在外层嵌套的作用域中继续查找，直到找到该变量，或抵达最外层作用域（也就是全局作用域）为止。
### 异常
区分LHS与RHS是很重要的，因为在变量还没有声明的情况下，这两种查询行为是不一样的。
考虑如下代码：
```javascript
function foo(a){
    console.log(a + b);
    b = a;
}

foo(2);
```
在“console.log(a + b)”中第一次对b进行RHS查询是无法找到改变量的。此时b还未声明，浏览器会抛出ReferenceError（引用错误）异常；而在“b = a”中对b执行LHS查询，在全局作用域中也无法找到目标变量，就会创建一个名为b的全局变量，并将其返还给引擎，前提是在非“严格模式”下。如果在“严格模式”下，也会抛出ReferenceError异常。
### 资料参考
1.你不知道的JavaScript（上卷）